<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<title>Calculadora de Viagens - RF Driver</title>

<!-- Fonte -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>

/* =========================================================
   VARI√ÅVEIS DO TEMA (padronizadas)
========================================================= */
:root{
    --bg:#f6f7fb;
    --card:#ffffff;
    --panel:#f1f4f9;

    --text:#0b1115;
    --muted:#768088;

    --brand:#0b5bd7;
    --brand-dark:#073f8a;

    --danger:#ff3b30;

    --shadow:0 4px 16px rgba(15,30,45,0.08);
    --radius:14px;
}

/* DARK MODE */
.dark{
    --bg:#0f0f11;
    --card:#1a1b1e;
    --panel:#222326;
    --text:#f1f1f1;
    --muted:#9099a3;
    --shadow:0 4px 18px rgba(0,0,0,0.55);
}

/* BASE */
*{ box-sizing:border-box; font-family:'Inter',sans-serif; }

body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    padding-bottom:160px;
    overflow-x:hidden;
}

/* HEADER */
header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:18px 16px;
    max-width:980px;
    margin:0 auto 8px auto;
}

.brand{
    display:flex;
    align-items:center;
    gap:10px;
}

.logo{
    width:42px;
    height:42px;
    background:linear-gradient(135deg,var(--brand),var(--brand-dark));
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:800;
    font-size:18px;
    color:#fff;
}

.brand h1{
    margin:0;
    font-size:18px;
    font-weight:800;
}

#toggleTheme{
    width:44px;
    height:44px;
    border:none;
    border-radius:12px;
    background:var(--panel);
    box-shadow:var(--shadow);
    cursor:pointer;
    font-size:20px;
    color:var(--text);
}

/* CONTAINER */
.container{
    max-width:980px;
    margin:0 auto;
    padding:0 16px;
}

/* CARDS */
.card{
    background:var(--card);
    padding:18px;
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    margin-bottom:18px;
}

.card h2, .card h3{
    margin:0 0 12px 0;
    font-weight:700;
}

label{
    font-size:13px;
    font-weight:600;
    color:var(--muted);
    margin-top:10px;
    display:block;
}

input, select{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:1px solid transparent;
    background:var(--panel);
    color:var(--text);
    margin-top:4px;
    font-size:15px;
}

input:focus, select:focus{
    outline:none;
    border-color:var(--brand);
}

button{
    width:100%;
    padding:14px;
    border:none;
    border-radius:12px;
    background:var(--brand);
    font-weight:700;
    color:#fff;
    cursor:pointer;
    margin-top:16px;
}

#resultado{
    background:var(--panel);
    padding:14px;
    border-radius:12px;
    margin-top:10px;
    white-space:pre-wrap;
    font-weight:700;
    color:var(--brand-dark);
    border-left:6px solid var(--brand-dark);
}

/* MENU INFERIOR PADR√ÉO */
.bottom-menu{
    position:fixed;
    bottom:18px;
    left:50%;
    transform:translateX(-50%);
    width:92%;
    max-width:980px;
    background:linear-gradient(135deg,var(--brand),var(--brand-dark));
    padding:10px 0;
    border-radius:18px;
    display:flex;
    justify-content:space-around;
    box-shadow:0 12px 28px rgba(0,0,0,0.35);
    z-index:999;
}

.menu-item{
    text-decoration:none;
    text-align:center;
    color:#fff;
    font-size:13px;
    font-weight:700;
    display:flex;
    flex-direction:column;
    gap:4px;
}

.menu-item .icon{
    font-size:20px;
}

.menu-item.active{
    transform:scale(1.06);
}

</style>
</head>

<body>

<header>
    <div class="brand">
        <div class="logo">RF</div>
        <h1>Calculadora</h1>
    </div>
    <button id="toggleTheme">üåô</button>
</header>

<div class="container">

    <!-- CARD PERFIL -->
    <div class="card">
        <h3>Informa√ß√µes do Motorista</h3>

        <label>Motorista</label>
        <input id="motorista">

        <label>CPF/CNPJ</label>
        <input id="cpfCnpj">

        <label>Carro / Modelo</label>
        <input id="carro">

        <label>Placa</label>
        <input id="placa">

        <label>Origem</label>
        <input id="origem">

        <label>Destino</label>
        <input id="destino">

        <label>Valor por KM</label>
        <input id="valorKm" type="number" step="0.01">

        <label>KM Rodado</label>
        <input id="kmRodado" type="number" step="0.01">

        <label>Dura√ß√£o (minutos)</label>
        <input id="duracaoMin" type="number">

        <label>Tipo de uso</label>
        <select id="tipoUso">
            <option value="cidade">Cidade</option>
            <option value="pista">Pista</option>
        </select>

        <label>Tipo de viagem</label>
        <select id="tipoViagem">
            <option value="soIdaComVolta">S√≥ ida (com volta)</option>
            <option value="soIdaSemVolta">S√≥ ida (sem volta)</option>
            <option value="idaVoltaEspera">Ida e volta + espera</option>
            <option value="idaVolta">Ida e volta</option>
            <option value="bateVolta">Bate e volta</option>
        </select>
    </div>

    <!-- CARD GNV -->
    <div class="card">
        <h3>Informa√ß√µes GNV</h3>

        <label>Valor cilindro cheio</label>
        <input id="valorCilindro" type="number" step="0.01">

        <label>Autonomia Cidade (KM)</label>
        <input id="autonomiaCidade" type="number">

        <label>Autonomia Pista (KM)</label>
        <input id="autonomiaPista" type="number">

        <button onclick="salvarGNV()">Salvar GNV</button>
    </div>

    <!-- CARD GASOLINA / ETANOL -->
    <div class="card">
        <h3>Gasolina / Etanol</h3>

        <h4 style="margin-bottom:6px;">Gasolina</h4>
        <label>Valor tanque cheio</label>
        <input id="gasolinaValor" type="number" step="0.01">

        <label>Autonomia Cidade (km/l)</label>
        <input id="gasolinaCidade" type="number">

        <label>Autonomia Pista (km/l)</label>
        <input id="gasolinaPista" type="number">

        <h4 style="margin-top:18px;margin-bottom:6px;">Etanol</h4>
        <label>Valor tanque cheio</label>
        <input id="etanolValor" type="number" step="0.01">

        <label>Autonomia Cidade (km/l)</label>
        <input id="etanolCidade" type="number">

        <label>Autonomia Pista (km/l)</label>
        <input id="etanolPista" type="number">

        <button onclick="salvarCombustiveis()">Salvar Gasolina/Etanol</button>
    </div>

    <!-- BOT√ïES -->
    <button onclick="calcularEstimativa()">Calcular Estimativa</button>
    <button onclick="enviarWhatsApp()">Enviar WhatsApp</button>

    <!-- RESULTADO -->
    <div id="resultado"></div>

</div>

<!-- MENU INFERIOR -->
<nav class="bottom-menu">
    <a href="index.html" class="menu-item"><span class="icon">üè†</span>Dashboard</a>
    <a href="entradas.html" class="menu-item"><span class="icon">üíµ</span>Entradas</a>
    <a href="manutencao.html" class="menu-item"><span class="icon">üõ†Ô∏è</span>Manuten√ß√£o</a>
    <a href="resumo.html" class="menu-item"><span class="icon">üìä</span>Resumo</a>
    <a href="perfil.html" class="menu-item"><span class="icon">üë§</span>Perfil</a>
    <a href="calculadora.html" class="menu-item active"><span class="icon">üìü</span>Calc</a>
</nav>

<!-- SCRIPT ORIGINAL (APENAS MOVIDO) -->
<script>
/*==== TEMA ====*/
function applyTheme(){
    const theme = localStorage.getItem("theme") || "light";
    if(theme === "dark"){
        document.body.classList.add("dark");
        toggleTheme.textContent = "‚òÄÔ∏è";
    } else {
        document.body.classList.remove("dark");
        toggleTheme.textContent = "üåô";
    }
}
toggleTheme.onclick = ()=>{
    let t = document.body.classList.contains("dark") ? "light" : "dark";
    localStorage.setItem("theme", t);
    applyTheme();
};
applyTheme();

/* ===== FORMATADOR ===== */
function fmt(valor){
    if(valor === Infinity || isNaN(valor)) return "N/D";
    return "R$ " + Number(valor).toFixed(2);
}

/* ===== PERFIL ===== */
const PERFIL_KEY = "perfilCalc";
function salvarPerfil(){
    const p = {
        motorista: motorista.value,
        cpfCnpj: cpfCnpj.value,
        carro: carro.value,
        placa: placa.value
    };
    localStorage.setItem(PERFIL_KEY, JSON.stringify(p));
}
function carregarPerfil(){
    const p = JSON.parse(localStorage.getItem(PERFIL_KEY) || "{}");
    if(p.motorista) motorista.value = p.motorista;
    if(p.cpfCnpj) cpfCnpj.value = p.cpfCnpj;
    if(p.carro) carro.value = p.carro;
    if(p.placa) placa.value = p.placa;
}
["motorista","cpfCnpj","carro","placa"].forEach(id=>{
    document.getElementById(id).addEventListener("input", salvarPerfil);
});
carregarPerfil();

/* ===== SALVAR DADOS GNV ===== */
function salvarGNV(){
    const dados = {
        valorCilindro:Number(valorCilindro.value) || 0,
        autonomiaCidade:Number(autonomiaCidade.value) || 0,
        autonomiaPista:Number(autonomiaPista.value) || 0
    };
    localStorage.setItem("gnvData", JSON.stringify(dados));
    alert("GNV salvo!");
}
function carregarGNV(){
    const g = JSON.parse(localStorage.getItem("gnvData") || "{}");
    if(g.valorCilindro) valorCilindro.value = g.valorCilindro;
    if(g.autonomiaCidade) autonomiaCidade.value = g.autonomiaCidade;
    if(g.autonomiaPista) autonomiaPista.value = g.autonomiaPista;
}
carregarGNV();

/* ===== GASOLINA / ETANOL ===== */
function salvarCombustiveis(){
    const dados = {
        gasolinaValor: Number(gasolinaValor.value) || 0,
        gasolinaCidade: Number(gasolinaCidade.value) || 0,
        gasolinaPista: Number(gasolinaPista.value) || 0,
        etanolValor: Number(etanolValor.value) || 0,
        etanolCidade: Number(etanolCidade.value) || 0,
        etanolPista: Number(etanolPista.value) || 0
    };
    localStorage.setItem("combData", JSON.stringify(dados));
    alert("Gasolina / Etanol salvos!");
}
function carregarCombustiveis(){
    const c = JSON.parse(localStorage.getItem("combData") || "{}");
    if(c.gasolinaValor) gasolinaValor.value = c.gasolinaValor;
    if(c.gasolinaCidade) gasolinaCidade.value = c.gasolinaCidade;
    if(c.gasolinaPista) gasolinaPista.value = c.gasolinaPista;
    if(c.etanolValor) etanolValor.value = c.etanolValor;
    if(c.etanolCidade) etanolCidade.value = c.etanolCidade;
    if(c.etanolPista) etanolPista.value = c.etanolPista;
}
carregarCombustiveis();

/* ===== C√ÅLCULO ===== */
let valorTotalBrutoGlobal = 0;
let duracaoMinGlobal = 0;

function calcularEstimativa(){
    const km = Number(kmRodado.value);
    const valKm = Number(valorKm.value);
    const dur = Number(duracaoMin.value);

    if(!km || !valKm || !dur){
        alert("Preencha KM, valor por KM e dura√ß√£o.");
        return;
    }

    const gnv = JSON.parse(localStorage.getItem("gnvData") || "{}");
    const comb = JSON.parse(localStorage.getItem("combData") || "{}");

    let bruto = valKm * km;

    switch(tipoViagem.value){
        case "idaVolta": bruto *= 2; break;
        case "idaVoltaEspera": bruto = (valKm * km * 2) * 1.10; break;
        case "bateVolta": bruto = (valKm * km * 2) / 1.25; break;
    }

    const uso = tipoUso.value;

    function calcCusto(valorTanque, autoCidade, autoPista){
        const autonomia = uso === "cidade" ? autoCidade : autoPista;
        if(!valorTanque || !autonomia) return Infinity;
        let custo = (valorTanque / autonomia) * km;
        if(tipoViagem.value !== "soIdaSemVolta") custo *= 2;
        return custo;
    }

    const custoGnv = calcCusto(gnv.valorCilindro, gnv.autonomiaCidade, gnv.autonomiaPista);
    const custoGas = calcCusto(comb.gasolinaValor, comb.gasolinaCidade, comb.gasolinaPista);
    const custoEta = calcCusto(comb.etanolValor, comb.etanolCidade, comb.etanolPista);

    const menor = Math.min(custoGnv, custoGas, custoEta);
    const melhor =
        menor === custoGnv ? "GNV" :
        menor === custoGas ? "Gasolina" : "Etanol";

    const liquido = bruto - menor;

    valorTotalBrutoGlobal = bruto;
    duracaoMinGlobal = dur;

    resultado.innerText =
`Valor Bruto: ${fmt(bruto)}

Custo GNV: ${fmt(custoGnv)}
Custo Gasolina: ${fmt(custoGas)}
Custo Etanol: ${fmt(custoEta)}

‚û° Combust√≠vel mais barato: ${melhor}

Lucro final usando ${melhor}: ${fmt(liquido)}

Dura√ß√£o: ${dur} min`;
}

/* ===== WHATSAPP ===== */
function enviarWhatsApp(){
    if(!valorTotalBrutoGlobal){
        alert("Fa√ßa o c√°lculo primeiro.");
        return;
    }

    const msg =
`üöñ C√°lculo de Viagem

Bruto: ${fmt(valorTotalBrutoGlobal)}
Dura√ß√£o: ${duracaoMinGlobal} min`;

    window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`);
}
</script>

</body>
</html>
