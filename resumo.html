<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Resumo - Motorista App</title>

<style>
:root{
    --bg:#121212;
    --card:#1E1E1E;
    --panel:#2A2A2A;
    --accent:#1DB954;
    --danger:#ff3b30;
    --muted:#bbb;
}

body{
    margin:0;
    background:var(--bg);
    color:#fff;
    font-family:Arial, sans-serif;
    padding-bottom:140px;
}

/* HEADER */
header{
    background:var(--accent);
    padding:14px;
    text-align:center;
    color:#000;
    font-weight:bold;
    font-size:20px;
}

/* Container */
.container{
    max-width:900px;
    margin:20px auto;
    padding:0 16px;
}

/* Top quadrants */
.top-row{
    display:flex;
    gap:16px;
    flex-wrap:wrap;
}

.cardTop{
    flex:1;
    background:var(--card);
    border-radius:12px;
    padding:16px;
    text-align:center;
    box-shadow:0 4px 16px rgba(0,0,0,0.4);
}

.cardTop h3{
    margin:0;
    font-size:14px;
    color:var(--muted);
}

.cardTop .value{
    font-size:28px;
    font-weight:700;
    margin-top:8px;
}

/* Filters */
.filters{
    display:flex;
    gap:10px;
    margin-top:20px;
}

.filters button{
    flex:1;
    padding:10px;
    border:none;
    border-radius:10px;
    background:var(--panel);
    color:#fff;
    font-weight:bold;
    cursor:pointer;
}

.filters .active{
    background:var(--accent);
    color:#000;
}

/* SUMMARY CARD */
.card{
    margin-top:20px;
    background:var(--card);
    padding:16px;
    border-radius:12px;
    box-shadow:0 4px 16px rgba(0,0,0,0.4);
}

.card h2{
    margin:0 0 10px 0;
}

.line{
    display:flex;
    justify-content:space-between;
    padding:8px 0;
    border-bottom:1px solid #333;
    font-size:14px;
}

/* Chart */
.chartRow{
    display:flex;
    justify-content:center;
    align-items:flex-end;
    gap:20px;
    margin-top:20px;
}

.bar{
    width:28%;
    background:#0b0b0b;
    border-radius:10px 10px 0 0;
    padding-top:6px;
}

.bar .inner{
    width:70%;
    margin:0 auto;
    background:var(--accent);
    border-radius:8px 8px 0 0;
    display:flex;
    align-items:flex-end;
    justify-content:center;
    padding-bottom:6px;
    font-weight:bold;
    color:#000;
}

.barLabel{
    text-align:center;
    margin-top:6px;
    color:var(--muted);
}

/* Bottom menu */
.bottom-menu{
    position:fixed;
    bottom:15px;
    left:50%;
    transform:translateX(-50%);
    width:88%;
    background:#1B1B1B;
    padding:10px 0;
    border-radius:18px;
    display:flex;
    justify-content:space-around;
    box-shadow:0 6px 25px rgba(0,0,0,0.6);
    z-index:1000;
}
.bottom-menu .menu-item{
    text-align:center;
    color:#fff;
    text-decoration:none;
    font-size:13px;
    display:flex;
    flex-direction:column;
    align-items:center;
}
.bottom-menu .icon{
    font-size:22px;
    margin-bottom:4px;
}
.bottom-menu .active{
    color:var(--accent);
}

</style>
</head>
<body>

<header>Resumo</header>

<div class="container">

    <!-- TOP QUADRANTS -->
    <div class="top-row">
        <div class="cardTop">
            <h3>Faturamento</h3>
            <div id="valFaturamento">R$ 0,00</div>
        </div>

        <div class="cardTop">
            <h3>Despesas</h3>
            <div id="valDespesas">R$ 0,00</div>
        </div>

        <div class="cardTop">
            <h3>Lucro L√≠quido</h3>
            <div id="valLucro">R$ 0,00</div>
        </div>
    </div>

    <!-- FILTERS -->
    <div class="filters">
        <button id="fDia" class="active" onclick="setFiltro('dia')">Hoje</button>
        <button id="fSemana" onclick="setFiltro('semana')">Semana</button>
        <button id="fMes" onclick="setFiltro('mes')">M√™s</button>
    </div>

    <!-- RESUMO POR M√âTODO DE PAGAMENTO -->
    <div class="card">
        <h2>Resumo por M√©todo</h2>

        <div class="line"><span>Dinheiro:</span> <strong id="mDinheiro">R$ 0,00</strong></div>
        <div class="line"><span>PIX:</span> <strong id="mPix">R$ 0,00</strong></div>
        <div class="line"><span>Cart√£o:</span> <strong id="mCartao">R$ 0,00</strong></div>
        <div class="line"><span>App (Uber/99):</span> <strong id="mApp">R$ 0,00</strong></div>
        <div class="line"><span>Outras entradas:</span> <strong id="mOutras">R$ 0,00</strong></div>
    </div>

    <!-- RESUMO POR CATEGORIA -->
    <div class="card">
        <h2>Resumo por Categoria</h2>

        <div class="line"><span>Uber:</span> <strong id="cUber">R$ 0,00</strong></div>
        <div class="line"><span>99:</span> <strong id="c99">R$ 0,00</strong></div>
        <div class="line"><span>InDriver:</span> <strong id="cInDriver">R$ 0,00</strong></div>
        <div class="line"><span>Particular:</span> <strong id="cParticular">R$ 0,00</strong></div>
        <div class="line"><span>Empresa:</span> <strong id="cEmpresa">R$ 0,00</strong></div>
    </div>

    <!-- MINI CHART -->
    <div class="card">
        <h2>Desempenho</h2>

        <div class="chartRow">
            <div class="bar">
                <div id="barFat" class="inner" style="height:10%">0%</div>
                <div class="barLabel">Faturamento</div>
            </div>

            <div class="bar">
                <div id="barDesp" class="inner" style="height:10%">0%</div>
                <div class="barLabel">Despesas</div>
            </div>

            <div class="bar">
                <div id="barLucro" class="inner" style="height:10%">0%</div>
                <div class="barLabel">Lucro</div>
            </div>
        </div>
    </div>

</div>

<!-- MENU -->
<nav class="bottom-menu">
    <a href="index.html" class="menu-item"><span class="icon">üè†</span><span>Dashboard</span></a>
    <a href="entradas.html" class="menu-item"><span class="icon">üíµ</span><span>Entradas</span></a>
    <a href="manutencao.html" class="menu-item"><span class="icon">üõ†Ô∏è</span><span>Manuten√ß√£o</span></a>
    <a href="resumo.html" class="menu-item active"><span class="icon">üìä</span><span>Resumo</span></a>
    <a href="perfil.html" class="menu-item"><span class="icon">üë§</span><span>Perfil</span></a>
    <a href="calculadora.html" class="menu-item"><span class="icon">üìü</span><span>Calc</span></a>
</nav>

<script>
/* UTIL */
const $ = id => document.getElementById(id);
const brl = v => Number(v||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

/* STATES */
let filtro = "dia";

function setFiltro(f){
    filtro = f;
    document.querySelectorAll(".filters button").forEach(b=>b.classList.remove("active"));
    $("f" + f.charAt(0).toUpperCase() + f.slice(1)).classList.add("active");
    atualizarResumo();
}

/* DATE FILTERS */
function isToday(date){
    const n = new Date();
    return date.getFullYear()===n.getFullYear() &&
           date.getMonth()===n.getMonth() &&
           date.getDate()===n.getDate();
}

function isSameWeek(date){
    const now = new Date();
    const first = now.getDate() - now.getDay() + 1;
    const start = new Date(now.setDate(first));
    const end = new Date(now.setDate(first+6));
    return date >= start && date <= end;
}

function isSameMonth(date){
    const now = new Date();
    return date.getFullYear()===now.getFullYear() &&
           date.getMonth()===now.getMonth();
}

function filtrarData(d){
    if(filtro==="dia") return isToday(d);
    if(filtro==="semana") return isSameWeek(d);
    return isSameMonth(d);
}

/* MAIN */
function atualizarResumo(){

    let registros = JSON.parse(localStorage.getItem("entradasSaidas") || "[]");

    let fat = 0, desp = 0;
    let mDin=0, mPix=0, mCar=0, mApp=0, mOut=0;
    let cU=0,c99=0,cInd=0,cPar=0,cEmp=0;

    registros.forEach(r=>{
        const d = new Date(r.criadoEm);
        if(!filtrarData(d)) return;

        const v = Number(r.valor || 0);

        if(r.tipo==="entrada"){
            fat += v;

            // pagamento
            if(r.formaPag==="dinheiro") mDin+=v;
            else if(r.formaPag==="pix") mPix+=v;
            else if(r.formaPag==="cartao") mCar+=v;
            else if(r.formaPag==="appMobile") mApp+=v;
            else mOut+=v;

            // categoria
            if(r.appTipo==="uber") cU+=v;
            else if(r.appTipo==="99") c99+=v;
            else if(r.appTipo==="indriver") cInd+=v;

            if(r.categoria==="particular") cPar+=v;
            if(r.categoria==="empresa") cEmp+=v;

        } else {
            desp += v;

            // dedu√ß√µes por m√©todo
            if(r.formaPag==="dinheiro") mDin-=v;
            else if(r.formaPag==="pix") mPix-=v;
            else if(r.formaPag==="cartao") mCar-=v;
        }
    });

    let lucro = fat - desp;

    // TOP
    $("valFaturamento").innerText = brl(fat);
    $("valDespesas").innerText = brl(desp);
    $("valLucro").innerText = brl(lucro);

    $("valLucro").style.color = lucro>=0 ? "var(--accent)" : "var(--danger)";

    // M√âTODOS
    $("mDinheiro").innerText = brl(mDin);
    $("mPix").innerText = brl(mPix);
    $("mCartao").innerText = brl(mCar);
    $("mApp").innerText = brl(mApp);
    $("mOutras").innerText = brl(mOut);

    // CATEGORIAS
    $("cUber").innerText = brl(cU);
    $("c99").innerText = brl(c99);
    $("cInDriver").innerText = brl(cInd);
    $("cParticular").innerText = brl(cPar);
    $("cEmpresa").innerText = brl(cEmp);

    // GR√ÅFICO
    const max = Math.max(fat, desp, Math.abs(lucro), 10);
    $("barFat").style.height = (fat/max*100) + "%";
    $("barFat").innerText = Math.round(fat/max*100) + "%";

    $("barDesp").style.height = (desp/max*100) + "%";
    $("barDesp").innerText = Math.round(desp/max*100) + "%";

    const lucroPct = Math.abs(lucro)/max*100;
    $("barLucro").style.height = lucroPct + "%";
    $("barLucro").innerText = Math.round(lucroPct) + "%";
    $("barLucro").style.background = lucro>=0 ? "var(--accent)" : "var(--danger)";
}

window.onload = atualizarResumo;
</script>

</body>
</html>
